@namespace Watchtower
@using Watchtower.Data
@using MongoDB.Driver

@if (loaded) {
    <div>
        <h3>@host.hostname</h3>
        <p>@Resources.Count @(Resources.Count == 1 ? "resource" : "resources")</p>

        @foreach (var resource in Resources)
        {
            <ResourceComponent client=@client resource=@resource />
        }
    </div>
}

@code {
    [ParameterAttribute]
    public WatchtowerHost? host { get; set; }
    [ParameterAttribute]
    public MongoClient? client { get; set; }
    public List<WatchtowerResource> Resources { get; set; }
    public bool loaded { get; set; }

    protected override async Task OnInitializedAsync()
    {
        Resources = host.Resources(client);
        loaded = true;
    }
}
